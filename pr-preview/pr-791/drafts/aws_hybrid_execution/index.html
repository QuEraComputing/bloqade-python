<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The neutral atom computing software development kit."><link href=https://bloqade.quera.com/drafts/aws_hybrid_execution/ rel=canonical><link rel=icon href=../../assets/favicon.ico><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.4.14"><title>Hybrid Execution with AWS Hybrid Jobs - The Neutral Atom SDK</title><link rel=stylesheet href=../../assets/stylesheets/main.fad675c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.356b1318.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#hybrid-execution-with-aws-hybrid-jobs class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="The Neutral Atom SDK" class="md-header__button md-logo" aria-label="The Neutral Atom SDK" data-md-component=logo> <img src=../../assets/logo-dark.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The Neutral Atom SDK </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Hybrid Execution with AWS Hybrid Jobs </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=custom aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/QuEraComputing/bloqade-python title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> bloqade-python </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=https://queracomputing.github.io/bloqade-python-examples/latest/ class=md-tabs__link> Tutorials </a> </li> <li class=md-tabs__item> <a href=../../reference/overview/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../blog/2023/ class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=https://github.com/QuEraComputing/bloqade-python/blob/main/LICENSE class=md-tabs__link> License </a> </li> <li class=md-tabs__item> <a href=../../contributing/ class=md-tabs__link> Contributing </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="The Neutral Atom SDK" class="md-nav__button md-logo" aria-label="The Neutral Atom SDK" data-md-component=logo> <img src=../../assets/logo-dark.png alt=logo> </a> The Neutral Atom SDK </label> <div class=md-nav__source> <a href=https://github.com/QuEraComputing/bloqade-python title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> bloqade-python </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../home/bloqade_101/ class=md-nav__link> <span class=md-ellipsis> Bloqade 101 </span> </a> </li> <li class=md-nav__item> <a href=../../home/getting_started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../../home/advanced_usage/ class=md-nav__link> <span class=md-ellipsis> Advanced Usage </span> </a> </li> <li class=md-nav__item> <a href=../../home/gotchas/ class=md-nav__link> <span class=md-ellipsis> Gotchas </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://queracomputing.github.io/bloqade-python-examples/latest/ class=md-nav__link> <span class=md-ellipsis> Tutorials </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/overview/ class=md-nav__link> <span class=md-ellipsis> Builder Overview </span> </a> </li> <li class=md-nav__item> <a href=../../reference/standard/ class=md-nav__link> <span class=md-ellipsis> Builder Standard Diagram </span> </a> </li> <li class=md-nav__item> <a href=../../reference/hardware-capabilities/ class=md-nav__link> <span class=md-ellipsis> Hardware Reference </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/ class="md-nav__link "> <span class=md-ellipsis> API References </span> </a> <label class="md-nav__link " for=__nav_3_4 id=__nav_3_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> API References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/atom_arrangement/ class=md-nav__link> <span class=md-ellipsis> Atom arrangement </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/constants/ class=md-nav__link> <span class=md-ellipsis> Constants </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/factory/ class=md-nav__link> <span class=md-ellipsis> Factory </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/serialize/ class=md-nav__link> <span class=md-ellipsis> Serialize </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_6> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/analysis/ class="md-nav__link "> <span class=md-ellipsis> Analysis </span> </a> <label class="md-nav__link " for=__nav_3_4_6 id=__nav_3_4_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_6> <span class="md-nav__icon md-icon"></span> Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_6_2> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/analysis/common/ class="md-nav__link "> <span class=md-ellipsis> Common </span> </a> <label class="md-nav__link " for=__nav_3_4_6_2 id=__nav_3_4_6_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_6_2> <span class="md-nav__icon md-icon"></span> Common </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/common/assignment_scan/ class=md-nav__link> <span class=md-ellipsis> Assignment scan </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/common/is_constant/ class=md-nav__link> <span class=md-ellipsis> Is constant </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/common/is_hyperfine/ class=md-nav__link> <span class=md-ellipsis> Is hyperfine </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/common/scan_channels/ class=md-nav__link> <span class=md-ellipsis> Scan channels </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/common/scan_variables/ class=md-nav__link> <span class=md-ellipsis> Scan variables </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_6_3> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/analysis/hardware/ class="md-nav__link "> <span class=md-ellipsis> Hardware </span> </a> <label class="md-nav__link " for=__nav_3_4_6_3 id=__nav_3_4_6_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_6_3> <span class="md-nav__icon md-icon"></span> Hardware </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/analysis/hardware/quera/ class=md-nav__link> <span class=md-ellipsis> Quera </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_7> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/builder/ class="md-nav__link "> <span class=md-ellipsis> Builder </span> </a> <label class="md-nav__link " for=__nav_3_4_7 id=__nav_3_4_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_7> <span class="md-nav__icon md-icon"></span> Builder </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/builder/args/ class=md-nav__link> <span class=md-ellipsis> Args </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/assign/ class=md-nav__link> <span class=md-ellipsis> Assign </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/coupling/ class=md-nav__link> <span class=md-ellipsis> Coupling </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/drive/ class=md-nav__link> <span class=md-ellipsis> Drive </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/field/ class=md-nav__link> <span class=md-ellipsis> Field </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/parallelize/ class=md-nav__link> <span class=md-ellipsis> Parallelize </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/pragmas/ class=md-nav__link> <span class=md-ellipsis> Pragmas </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/route/ class=md-nav__link> <span class=md-ellipsis> Route </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/sequence_builder/ class=md-nav__link> <span class=md-ellipsis> Sequence builder </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/spatial/ class=md-nav__link> <span class=md-ellipsis> Spatial </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/start/ class=md-nav__link> <span class=md-ellipsis> Start </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/typing/ class=md-nav__link> <span class=md-ellipsis> Typing </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/waveform/ class=md-nav__link> <span class=md-ellipsis> Waveform </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_7_15> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/builder/backend/ class="md-nav__link "> <span class=md-ellipsis> Backend </span> </a> <label class="md-nav__link " for=__nav_3_4_7_15 id=__nav_3_4_7_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_7_15_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_7_15> <span class="md-nav__icon md-icon"></span> Backend </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/builder/backend/bloqade/ class=md-nav__link> <span class=md-ellipsis> Bloqade </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/backend/braket/ class=md-nav__link> <span class=md-ellipsis> Braket </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/backend/quera/ class=md-nav__link> <span class=md-ellipsis> Quera </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_7_16> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/builder/parse/ class="md-nav__link "> <span class=md-ellipsis> Parse </span> </a> <label class="md-nav__link " for=__nav_3_4_7_16 id=__nav_3_4_7_16_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_7_16_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_7_16> <span class="md-nav__icon md-icon"></span> Parse </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/builder/parse/builder/ class=md-nav__link> <span class=md-ellipsis> Builder </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/parse/stream/ class=md-nav__link> <span class=md-ellipsis> Stream </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/builder/parse/trait/ class=md-nav__link> <span class=md-ellipsis> Trait </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_8> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/emulate/ class="md-nav__link "> <span class=md-ellipsis> Emulate </span> </a> <label class="md-nav__link " for=__nav_3_4_8 id=__nav_3_4_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_8> <span class="md-nav__icon md-icon"></span> Emulate </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/emulate/sparse_operator/ class=md-nav__link> <span class=md-ellipsis> Sparse operator </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_8_3> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/emulate/ir/ class="md-nav__link "> <span class=md-ellipsis> Ir </span> </a> <label class="md-nav__link " for=__nav_3_4_8_3 id=__nav_3_4_8_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_8_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_8_3> <span class="md-nav__icon md-icon"></span> Ir </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/emulate/ir/atom_type/ class=md-nav__link> <span class=md-ellipsis> Atom type </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/emulate/ir/emulator/ class=md-nav__link> <span class=md-ellipsis> Emulator </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/emulate/ir/space/ class=md-nav__link> <span class=md-ellipsis> Space </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/emulate/ir/state_vector/ class=md-nav__link> <span class=md-ellipsis> State vector </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_9> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/ir/ class="md-nav__link "> <span class=md-ellipsis> Ir </span> </a> <label class="md-nav__link " for=__nav_3_4_9 id=__nav_3_4_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_9_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_9> <span class="md-nav__icon md-icon"></span> Ir </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/ir/analog_circuit/ class=md-nav__link> <span class=md-ellipsis> Analog circuit </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/scalar/ class=md-nav__link> <span class=md-ellipsis> Scalar </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_9_4> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/ir/control/ class="md-nav__link "> <span class=md-ellipsis> Control </span> </a> <label class="md-nav__link " for=__nav_3_4_9_4 id=__nav_3_4_9_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_9_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_9_4> <span class="md-nav__icon md-icon"></span> Control </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/ir/control/field/ class=md-nav__link> <span class=md-ellipsis> Field </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/control/pulse/ class=md-nav__link> <span class=md-ellipsis> Pulse </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/control/sequence/ class=md-nav__link> <span class=md-ellipsis> Sequence </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/control/waveform/ class=md-nav__link> <span class=md-ellipsis> Waveform </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_9_5> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/ir/location/ class="md-nav__link "> <span class=md-ellipsis> Location </span> </a> <label class="md-nav__link " for=__nav_3_4_9_5 id=__nav_3_4_9_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_9_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_9_5> <span class="md-nav__icon md-icon"></span> Location </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/ir/location/bravais/ class=md-nav__link> <span class=md-ellipsis> Bravais </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/location/location/ class=md-nav__link> <span class=md-ellipsis> Location </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_9_6> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/ir/routine/ class="md-nav__link "> <span class=md-ellipsis> Routine </span> </a> <label class="md-nav__link " for=__nav_3_4_9_6 id=__nav_3_4_9_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_9_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_9_6> <span class="md-nav__icon md-icon"></span> Routine </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/ir/routine/base/ class=md-nav__link> <span class=md-ellipsis> Base </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/routine/bloqade/ class=md-nav__link> <span class=md-ellipsis> Bloqade </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/routine/braket/ class=md-nav__link> <span class=md-ellipsis> Braket </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/routine/params/ class=md-nav__link> <span class=md-ellipsis> Params </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/ir/routine/quera/ class=md-nav__link> <span class=md-ellipsis> Quera </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_10> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/rewrite/ class="md-nav__link "> <span class=md-ellipsis> Rewrite </span> </a> <label class="md-nav__link " for=__nav_3_4_10 id=__nav_3_4_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_10_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_10> <span class="md-nav__icon md-icon"></span> Rewrite </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_10_2> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/rewrite/common/ class="md-nav__link "> <span class=md-ellipsis> Common </span> </a> <label class="md-nav__link " for=__nav_3_4_10_2 id=__nav_3_4_10_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_10_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_10_2> <span class="md-nav__icon md-icon"></span> Common </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/rewrite/common/assign_variables/ class=md-nav__link> <span class=md-ellipsis> Assign variables </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/rewrite/common/flatten_sequence/ class=md-nav__link> <span class=md-ellipsis> Flatten sequence </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_11> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/submission/ class="md-nav__link "> <span class=md-ellipsis> Submission </span> </a> <label class="md-nav__link " for=__nav_3_4_11 id=__nav_3_4_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_11> <span class="md-nav__icon md-icon"></span> Submission </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/submission/base/ class=md-nav__link> <span class=md-ellipsis> Base </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/braket/ class=md-nav__link> <span class=md-ellipsis> Braket </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/load_config/ class=md-nav__link> <span class=md-ellipsis> Load config </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/mock/ class=md-nav__link> <span class=md-ellipsis> Mock </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/quera/ class=md-nav__link> <span class=md-ellipsis> Quera </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_11_7> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/submission/ir/ class="md-nav__link "> <span class=md-ellipsis> Ir </span> </a> <label class="md-nav__link " for=__nav_3_4_11_7 id=__nav_3_4_11_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_3_4_11_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_11_7> <span class="md-nav__icon md-icon"></span> Ir </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/submission/ir/braket/ class=md-nav__link> <span class=md-ellipsis> Braket </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/ir/capabilities/ class=md-nav__link> <span class=md-ellipsis> Capabilities </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/ir/parallel/ class=md-nav__link> <span class=md-ellipsis> Parallel </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/ir/task_results/ class=md-nav__link> <span class=md-ellipsis> Task results </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/submission/ir/task_specification/ class=md-nav__link> <span class=md-ellipsis> Task specification </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_12> <div class="md-nav__link md-nav__container"> <a href=../../reference/bloqade/task/ class="md-nav__link "> <span class=md-ellipsis> Task </span> </a> <label class="md-nav__link " for=__nav_3_4_12 id=__nav_3_4_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_12_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_12> <span class="md-nav__icon md-icon"></span> Task </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/bloqade/task/base/ class=md-nav__link> <span class=md-ellipsis> Base </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/task/batch/ class=md-nav__link> <span class=md-ellipsis> Batch </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/task/bloqade/ class=md-nav__link> <span class=md-ellipsis> Bloqade </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/task/braket/ class=md-nav__link> <span class=md-ellipsis> Braket </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/task/braket_simulator/ class=md-nav__link> <span class=md-ellipsis> Braket simulator </span> </a> </li> <li class=md-nav__item> <a href=../../reference/bloqade/task/quera/ class=md-nav__link> <span class=md-ellipsis> Quera </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_1> <div class="md-nav__link md-nav__container"> <a href=../../blog/2023/ class="md-nav__link "> <span class=md-ellipsis> 2023 </span> </a> <label class="md-nav__link " for=__nav_4_1 id=__nav_4_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> 2023 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2023/posts/bloqade-release/ class=md-nav__link> <span class=md-ellipsis> Introducing Bloqade SDK for Python </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://github.com/QuEraComputing/bloqade-python/blob/main/LICENSE class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../contributing/ class="md-nav__link "> <span class=md-ellipsis> Contributing </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Contributing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../contributing/reporting-a-bug/ class=md-nav__link> <span class=md-ellipsis> Reporting Bugs </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/documentation-issues/ class=md-nav__link> <span class=md-ellipsis> Reporting Documentation Issues </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/feature-requests/ class=md-nav__link> <span class=md-ellipsis> Feature Requests </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/developing-bloqade/ class=md-nav__link> <span class=md-ellipsis> Developing Bloqade </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/design-philosophy-and-architecture/ class=md-nav__link> <span class=md-ellipsis> Design Philosophy and Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/community-slack/ class=md-nav__link> <span class=md-ellipsis> Community Slack </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/asking-a-question/ class=md-nav__link> <span class=md-ellipsis> Asking a Question </span> </a> </li> <li class=md-nav__item> <a href=../../contributing/providing-feedback/ class=md-nav__link> <span class=md-ellipsis> Providing Feedback </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=#features-of-bloqade class=md-nav__link> <span class=md-ellipsis> Features of Bloqade </span> </a> <nav class=md-nav aria-label="Features of Bloqade"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#just-in-time-documentation class=md-nav__link> <span class=md-ellipsis> Just-in-time Documentation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#parameterized-programs class=md-nav__link> <span class=md-ellipsis> Parameterized Programs </span> </a> <nav class=md-nav aria-label="Parameterized Programs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#visualization-tools class=md-nav__link> <span class=md-ellipsis> Visualization Tools </span> </a> </li> <li class=md-nav__item> <a href=#bloqade-emulator class=md-nav__link> <span class=md-ellipsis> Bloqade Emulator </span> </a> </li> <li class=md-nav__item> <a href=#target-multiple-backends class=md-nav__link> <span class=md-ellipsis> Target Multiple Backends </span> </a> </li> <li class=md-nav__item> <a href=#job-management-features class=md-nav__link> <span class=md-ellipsis> Job management Features </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adaptive-workloads class=md-nav__link> <span class=md-ellipsis> Adaptive workloads </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/QuEraComputing/bloqade-python/edit/main/docs/drafts/aws_hybrid_execution.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg> </a> <a href=https://github.com/QuEraComputing/bloqade-python/raw/main/docs/drafts/aws_hybrid_execution.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg> </a> <h1 id=hybrid-execution-with-aws-hybrid-jobs>Hybrid Execution with AWS Hybrid Jobs<a class=headerlink href=#hybrid-execution-with-aws-hybrid-jobs title="Permanent link">&para;</a></h1> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">&para;</a></h2> <p>Analog Hamiltonian Simulation (AHS) has proven itself to be a powerful method of performing quantum computation that is well-suited for solving optimization problems and performing computationally difficult simulations of other quantum systems. Unlike its counterpart digital/gate-based quantum computing where you think of your programs in terms of unitary operations that are akin to classicla gates, you think of programs in AHS in terms of the geometry of your qubits (individual atoms!) and the waveforms of the lasers that are applied to them.</p> <p>The team at QuEra Computing believes this is a useful step in the path to fault tolerant quantum computation but also realizes that such novel power and capabilities require a novel tool.</p> <p>That's why we're proud to announce the release of the Bloqade SDK for Python! We've had the opportunity to obtain valuable feedback from the community and leveraged our unique position as the only provider of publicly cloud-accessible Nuetral Atom hardware to produce a tool that puts the power of AHS hardware at your fingertips.</p> <h2 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">&para;</a></h2> <p>Bloqade is a pure Python library so installation is as easy as <code>pip install bloqade</code>! Once installed you have a variety of options for building your Nuetral atom Analog program. We have worked very hard to provide a seamless user experience when venturing into unfamiliar territory of AHS with Nuetral Atoms! Let’s dig into some of the major features Bloqade has to offer!</p> <h2 id=features-of-bloqade>Features of Bloqade<a class=headerlink href=#features-of-bloqade title="Permanent link">&para;</a></h2> <h3 id=just-in-time-documentation>Just-in-time Documentation<a class=headerlink href=#just-in-time-documentation title="Permanent link">&para;</a></h3> <p>I know you have probably spent a pretty penny on your multi-monitor setup so that you do not have to switch between windows when writing code and looking at documentation. What if I told you there was a better way? What if your code contained all the documentation you needed to continue writing your program? That’s exactly what we have designed in the user experinence (UX) of Bloqade.</p> <p>Typically when building an AHS program one needs to construct many different objects and combine them in very particular ways which are not obvious without understanding the concept as a whole. Bloqade provides a unique experience programming AHS. Our interface eases the user into AHS programming by using Python’s rich type-hinting system. Most IDE's, as well as IPython and Jupyter, use the type hints to access to the methods and attributes that are availible to whatever object you currently have. We use this hinting to our advantage in Bloqade by building your AHS program with a chain of methods and attributes separated by <code>.</code>. In doing so you will be given hints as to what to do next at every step of the way when building your program.</p> <p><img alt src=https://hackmd.io/_uploads/rJnd8rNMT.gif></p> <p>While it is conventional thinking that it is bad to chain <code>.</code> statements together, there are some well known libraries like <a href=https://medium.com/@ulriktpedersen/modern-pandas-streamlining-your-workflow-with-method-chaining-f65e75deb193>Pandas</a> that can and do make heavy use of this pattern of programming. The dot-chaining syntax also integrate python linters like <a href=https://github.com/psf/black>black</a> to make your code highly readable without having to do anything other can call the linter on your python file.</p> <p>Example, before linter some unstrctured code <img alt src=https://hackmd.io/_uploads/Hk_t1BVfT.png> After running black we get consistent formatting. <img alt src=https://hackmd.io/_uploads/rkbckHNMp.png> In this case properties are always chained which makes reading the code a lot like reading a sentence.</p> <p>On top of these nice features, If you’re in an IDE like VS code or PyCharm you can access the documentation of each method and attribute in which we provide even more hints for the next step after your current selection</p> <p><img alt src="https://github.com/QuEraComputing/bloqade-python/blob/main/docs/assets/readme-gifs/smart-docs.gif?raw=True"></p> <p><a href=https://towardsdatascience.com/the-unreasonable-effectiveness-of-method-chaining-in-pandas-15c2109e3c69>Here</a> is a blog post that goes into the advantages and disadvantages of chaining method calls/attributes like we have shown. It worth a read if you are still a bit skeptical! It's worth noting that you do not neccesarily have to chain method/attribute calls you can safely store a intermediate parts of program with intermediate objects because calling a method <em>does not</em> act in the object in-place. This means you can</p> <h2 id=parameterized-programs>Parameterized Programs<a class=headerlink href=#parameterized-programs title="Permanent link">&para;</a></h2> <blockquote> <p>keep title capitalization consistent [name=jzlong]</p> </blockquote> <p>Many near-term applications for QC as well as AHS require some notion of parameterized programs. We’ve made this a first-class feature in Bloqade enabling you to write a single AHS program precisely to define your experiment or algorithm symbolically enabling more readable and sharable code!</p> <p>You can also create stand-alone variables which have a basic symbolic representation that support some arithmetic operations that are useful for more advanced AHS applications. For example, say I have a piecewise linear pulse that has variable segments but I have another constant waveform running for the total time of the other waveform. I can sum the durations of each segment of the piecewise linear waveform to get the total duration and use that to construct the constant waveform.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>from</span> <span class=nn>bloqade</span> <span class=kn>import</span> <span class=n>var</span><span class=p>,</span> <span class=n>start</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=n>rabi_durations</span> <span class=o>=</span> <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>var</span><span class=p>(</span><span class=s2>&quot;run_time&quot;</span><span class=p>),</span> <span class=mf>0.1</span><span class=p>]</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=n>total_time</span> <span class=o>=</span> <span class=nb>sum</span><span class=p>(</span><span class=n>rabi_durations</span><span class=p>)</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=n>program</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>start</span><span class=o>.</span><span class=n>add_position</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>    <span class=o>.</span><span class=n>rydberg</span><span class=o>.</span><span class=n>detuning</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>constant</span><span class=p>(</span><span class=n>total_time</span><span class=p>,</span> <span class=s2>&quot;detuning&quot;</span><span class=p>)</span>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=o>.</span><span class=n>amplitude</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>piecewise_linear</span><span class=p>(</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>        <span class=n>rabi_durations</span><span class=p>,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;amplitude&quot;</span><span class=p>,</span>  <span class=s2>&quot;amplitude&quot;</span><span class=p>,</span>  <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=p>)</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=p>)</span>
</span></code></pre></div> <p>Once you have defined your parameterized program there are three different methods of specifying the run time values of the parameters:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=n>program</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>var1</span><span class=o>=</span><span class=n>value1</span><span class=p>,</span> <span class=n>var2</span><span class=o>=</span><span class=n>value2</span><span class=p>)</span>
</span></code></pre></div> <p>which assigns the variables in a static way. The basic logic here is for segments of program in which you want to share without limiting other users to use the concrete values you decided works for you.</p> <p><div class="language-python highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>program</span><span class=o>.</span><span class=n>batch_assign</span><span class=p>(</span><span class=n>var1</span><span class=o>=</span><span class=p>[</span><span class=n>value1_1</span><span class=p>,</span> <span class=n>value1_2</span><span class=p>,</span> <span class=err>…</span><span class=p>],</span><span class=err>…</span><span class=p>)</span>
</span></code></pre></div> or</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>program</span><span class=o>.</span><span class=n>batch_assign</span><span class=p>([</span><span class=nb>dict</span><span class=p>(</span><span class=n>var1</span><span class=o>=</span><span class=n>value1_1</span><span class=p>,</span><span class=err>…</span><span class=p>),</span> <span class=nb>dict</span><span class=p>(</span><span class=n>var1</span><span class=o>=</span><span class=n>value1_2</span><span class=p>,</span><span class=err>…</span><span class=p>),</span><span class=err>…</span><span class=p>])</span>
</span></code></pre></div> <p>specify a batch of tasks via parameters assigned to lists or a list of dictionaries with the assigned parameters. Next,</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=n>args</span><span class=p>([</span><span class=err>“</span><span class=n>var1</span><span class=err>”</span><span class=p>,</span> <span class=err>“</span><span class=n>var2</span><span class=err>”</span><span class=p>])</span>
</span></code></pre></div> <p>will delay the assignment of the variable until the program is being executed. We will discuss this below in more detail.</p> <p>Note that none of these methods are required for non-parameterized programs. For parameterized programs you can mix and match all of these assignments together. However, they will always come in the order of <code>assign</code>, <code>batch_assign</code> then <code>args</code>. let's take the program above to give a concrete example.</p> <p>After specifying the program we can do the following assignment:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>assigned_program</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>program</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=n>amplitude</span><span class=o>=</span><span class=mf>15.7</span><span class=p>)</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>    <span class=o>.</span><span class=n>batch_assign</span><span class=p>(</span><span class=n>run_time</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=mf>0.05</span><span class=p>,</span> <span class=mf>3.0</span><span class=p>,</span> <span class=mi>101</span><span class=p>))</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=o>.</span><span class=n>args</span><span class=p>([</span><span class=s2>&quot;detuning&quot;</span><span class=p>])</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=p>)</span>
</span></code></pre></div> <p>First we assign the amplitude to a value of 15.7 which is going to be non-changing regardless of the other changing parameters in execution. Because we assign ‘run_time’ using <code>batch_assign</code> that means every time we execute this program we will run 101 tasks with the parameter sweep defined by the list of values. Finally <code>args([“detuning”])</code> implies that you must provide the value of the detuning as an argument when calling the execution method of the device. This is primarily useful for hybrid work flows or if you are simply just wanting to split your experiments into chunks defined by a different set of parameters. In conclusion, whether it is a hybrid algorithm or a parameter scan for your next fancy experiment Bloqade has you covered!</p> <h3 id=visualization-tools>Visualization Tools<a class=headerlink href=#visualization-tools title="Permanent link">&para;</a></h3> <p>While having a clean, readable syntax is great, there is always going to be the need for more visual representations. This is especially true for AHS programming where you think about things in terms of waveforms and atom configurations. As such, we provide visualization of your programs using <code>Bokeh</code>. Bokeh allows for very clean responsive interactive plots which we have implemented not only for AHS programs but AHS results as well!</p> <p><img alt src="https://github.com/QuEraComputing/bloqade-python/blob/main/docs/assets/readme-gifs/locations-hover.gif?raw=true"></p> <p><img alt src="https://github.com/QuEraComputing/bloqade-python/blob/main/docs/assets/readme-gifs/graph-select.gif?raw=true"></p> <p>We also provide some visualization of your AHS program in the terminal:</p> <div class="language-ipython highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=n>In</span> <span class=p>[</span><span class=mi>1</span><span class=p>]:</span> <span class=kn>from</span> <span class=nn>bloqade</span> <span class=kn>import</span> <span class=n>start</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>   <span class=o>...</span><span class=p>:</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>   <span class=o>...</span><span class=p>:</span> <span class=n>program</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>   <span class=o>...</span><span class=p>:</span>     <span class=n>start</span><span class=o>.</span><span class=n>add_position</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>   <span class=o>...</span><span class=p>:</span>     <span class=o>.</span><span class=n>add_position</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>))</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>   <span class=o>...</span><span class=p>:</span>     <span class=o>.</span><span class=n>rydberg</span><span class=o>.</span><span class=n>detuning</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>piecewise_linear</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=mi>20</span><span class=p>,</span> <span class=o>-</span><span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>,</span> <span class=mi>20</span><span class=p>])</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>   <span class=o>...</span><span class=p>:</span>     <span class=o>.</span><span class=n>amplitude</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>piecewise_linear</span><span class=p>([</span><span class=mf>0.1</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>15</span><span class=p>,</span> <span class=mi>0</span><span class=p>])</span>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>   <span class=o>...</span><span class=p>:</span>     <span class=o>.</span><span class=n>args</span><span class=p>([</span><span class=s2>&quot;r&quot;</span><span class=p>])</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a>   <span class=o>...</span><span class=p>:</span> <span class=p>)</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=n>In</span> <span class=p>[</span><span class=mi>2</span><span class=p>]:</span> <span class=n>program</span><span class=o>.</span><span class=n>parse_circuit</span><span class=p>()</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=n>Out</span><span class=p>[</span><span class=mi>2</span><span class=p>]:</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=n>AnalogCircuit</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=err>├─</span> <span class=n>register</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=err>│</span>  <span class=err>⇒</span> <span class=n>AtomArrangement</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=err>│</span>    <span class=err>├─</span> <span class=n>Location</span><span class=p>:</span> <span class=n>filled</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=err>│</span>    <span class=err>│</span>  <span class=err>├─</span> <span class=n>x</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=err>│</span>    <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=err>│</span>    <span class=err>│</span>  <span class=err>└─</span> <span class=n>y</span>
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=err>│</span>    <span class=err>│</span>     <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=err>│</span>    <span class=err>└─</span> <span class=n>Location</span><span class=p>:</span> <span class=n>filled</span>
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=err>│</span>       <span class=err>├─</span> <span class=n>x</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=err>│</span>       <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=err>│</span>       <span class=err>└─</span> <span class=n>y</span>
</span><span id=__span-6-25><a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=err>│</span>          <span class=err>⇒</span> <span class=n>Variable</span><span class=p>:</span> <span class=n>r</span>
</span><span id=__span-6-26><a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=err>└─</span> <span class=n>sequence</span>
</span><span id=__span-6-27><a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>   <span class=err>⇒</span> <span class=n>Sequence</span>
</span><span id=__span-6-28><a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a>     <span class=err>└─</span> <span class=n>RydbergLevelCoupling</span>
</span><span id=__span-6-29><a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a>        <span class=err>⇒</span> <span class=n>Pulse</span>
</span><span id=__span-6-30><a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a>          <span class=err>├─</span> <span class=n>Detuning</span>
</span><span id=__span-6-31><a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a>          <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Field</span>
</span><span id=__span-6-32><a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a>          <span class=err>│</span>    <span class=err>└─</span> <span class=n>Drive</span>
</span><span id=__span-6-33><a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a>          <span class=err>│</span>       <span class=err>├─</span> <span class=n>modulation</span>
</span><span id=__span-6-34><a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a>          <span class=err>│</span>       <span class=err>│</span>  <span class=err>⇒</span> <span class=n>UniformModulation</span>
</span><span id=__span-6-35><a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a>          <span class=err>│</span>       <span class=err>└─</span> <span class=n>waveform</span>
</span><span id=__span-6-36><a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a>          <span class=err>│</span>          <span class=err>⇒</span> <span class=n>Append</span>
</span><span id=__span-6-37><a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a>          <span class=err>│</span>            <span class=err>├─</span> <span class=n>Linear</span>
</span><span id=__span-6-38><a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-39><a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=o>-</span><span class=mi>20</span>
</span><span id=__span-6-40><a id=__codelineno-6-40 name=__codelineno-6-40 href=#__codelineno-6-40></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-41><a id=__codelineno-6-41 name=__codelineno-6-41 href=#__codelineno-6-41></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=o>-</span><span class=mi>20</span>
</span><span id=__span-6-42><a id=__codelineno-6-42 name=__codelineno-6-42 href=#__codelineno-6-42></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-43><a id=__codelineno-6-43 name=__codelineno-6-43 href=#__codelineno-6-43></a>          <span class=err>│</span>            <span class=err>│</span>     <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-6-44><a id=__codelineno-6-44 name=__codelineno-6-44 href=#__codelineno-6-44></a>          <span class=err>│</span>            <span class=err>├─</span> <span class=n>Linear</span>
</span><span id=__span-6-45><a id=__codelineno-6-45 name=__codelineno-6-45 href=#__codelineno-6-45></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-46><a id=__codelineno-6-46 name=__codelineno-6-46 href=#__codelineno-6-46></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=o>-</span><span class=mi>20</span>
</span><span id=__span-6-47><a id=__codelineno-6-47 name=__codelineno-6-47 href=#__codelineno-6-47></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-48><a id=__codelineno-6-48 name=__codelineno-6-48 href=#__codelineno-6-48></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>20</span>
</span><span id=__span-6-49><a id=__codelineno-6-49 name=__codelineno-6-49 href=#__codelineno-6-49></a>          <span class=err>│</span>            <span class=err>│</span>  <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-50><a id=__codelineno-6-50 name=__codelineno-6-50 href=#__codelineno-6-50></a>          <span class=err>│</span>            <span class=err>│</span>     <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>1.2</span>
</span><span id=__span-6-51><a id=__codelineno-6-51 name=__codelineno-6-51 href=#__codelineno-6-51></a>          <span class=err>│</span>            <span class=err>└─</span> <span class=n>Linear</span>
</span><span id=__span-6-52><a id=__codelineno-6-52 name=__codelineno-6-52 href=#__codelineno-6-52></a>          <span class=err>│</span>               <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-53><a id=__codelineno-6-53 name=__codelineno-6-53 href=#__codelineno-6-53></a>          <span class=err>│</span>               <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>20</span>
</span><span id=__span-6-54><a id=__codelineno-6-54 name=__codelineno-6-54 href=#__codelineno-6-54></a>          <span class=err>│</span>               <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-55><a id=__codelineno-6-55 name=__codelineno-6-55 href=#__codelineno-6-55></a>          <span class=err>│</span>               <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>20</span>
</span><span id=__span-6-56><a id=__codelineno-6-56 name=__codelineno-6-56 href=#__codelineno-6-56></a>          <span class=err>│</span>               <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-57><a id=__codelineno-6-57 name=__codelineno-6-57 href=#__codelineno-6-57></a>          <span class=err>│</span>                  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-6-58><a id=__codelineno-6-58 name=__codelineno-6-58 href=#__codelineno-6-58></a>          <span class=err>└─</span> <span class=n>RabiFrequencyAmplitude</span>
</span><span id=__span-6-59><a id=__codelineno-6-59 name=__codelineno-6-59 href=#__codelineno-6-59></a>             <span class=err>⇒</span> <span class=n>Field</span>
</span><span id=__span-6-60><a id=__codelineno-6-60 name=__codelineno-6-60 href=#__codelineno-6-60></a>               <span class=err>└─</span> <span class=n>Drive</span>
</span><span id=__span-6-61><a id=__codelineno-6-61 name=__codelineno-6-61 href=#__codelineno-6-61></a>                  <span class=err>├─</span> <span class=n>modulation</span>
</span><span id=__span-6-62><a id=__codelineno-6-62 name=__codelineno-6-62 href=#__codelineno-6-62></a>                  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>UniformModulation</span>
</span><span id=__span-6-63><a id=__codelineno-6-63 name=__codelineno-6-63 href=#__codelineno-6-63></a>                  <span class=err>└─</span> <span class=n>waveform</span>
</span><span id=__span-6-64><a id=__codelineno-6-64 name=__codelineno-6-64 href=#__codelineno-6-64></a>                     <span class=err>⇒</span> <span class=n>Append</span>
</span><span id=__span-6-65><a id=__codelineno-6-65 name=__codelineno-6-65 href=#__codelineno-6-65></a>                       <span class=err>├─</span> <span class=n>Linear</span>
</span><span id=__span-6-66><a id=__codelineno-6-66 name=__codelineno-6-66 href=#__codelineno-6-66></a>                       <span class=err>│</span>  <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-67><a id=__codelineno-6-67 name=__codelineno-6-67 href=#__codelineno-6-67></a>                       <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-68><a id=__codelineno-6-68 name=__codelineno-6-68 href=#__codelineno-6-68></a>                       <span class=err>│</span>  <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-69><a id=__codelineno-6-69 name=__codelineno-6-69 href=#__codelineno-6-69></a>                       <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>15</span>
</span><span id=__span-6-70><a id=__codelineno-6-70 name=__codelineno-6-70 href=#__codelineno-6-70></a>                       <span class=err>│</span>  <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-71><a id=__codelineno-6-71 name=__codelineno-6-71 href=#__codelineno-6-71></a>                       <span class=err>│</span>     <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>0.1</span>
</span><span id=__span-6-72><a id=__codelineno-6-72 name=__codelineno-6-72 href=#__codelineno-6-72></a>                       <span class=err>├─</span> <span class=n>Linear</span>
</span><span id=__span-6-73><a id=__codelineno-6-73 name=__codelineno-6-73 href=#__codelineno-6-73></a>                       <span class=err>│</span>  <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-74><a id=__codelineno-6-74 name=__codelineno-6-74 href=#__codelineno-6-74></a>                       <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>15</span>
</span><span id=__span-6-75><a id=__codelineno-6-75 name=__codelineno-6-75 href=#__codelineno-6-75></a>                       <span class=err>│</span>  <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-76><a id=__codelineno-6-76 name=__codelineno-6-76 href=#__codelineno-6-76></a>                       <span class=err>│</span>  <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>15</span>
</span><span id=__span-6-77><a id=__codelineno-6-77 name=__codelineno-6-77 href=#__codelineno-6-77></a>                       <span class=err>│</span>  <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-78><a id=__codelineno-6-78 name=__codelineno-6-78 href=#__codelineno-6-78></a>                       <span class=err>│</span>     <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>1.2</span>
</span><span id=__span-6-79><a id=__codelineno-6-79 name=__codelineno-6-79 href=#__codelineno-6-79></a>                       <span class=err>└─</span> <span class=n>Linear</span>
</span><span id=__span-6-80><a id=__codelineno-6-80 name=__codelineno-6-80 href=#__codelineno-6-80></a>                          <span class=err>├─</span> <span class=n>start</span>
</span><span id=__span-6-81><a id=__codelineno-6-81 name=__codelineno-6-81 href=#__codelineno-6-81></a>                          <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>15</span>
</span><span id=__span-6-82><a id=__codelineno-6-82 name=__codelineno-6-82 href=#__codelineno-6-82></a>                          <span class=err>├─</span> <span class=n>stop</span>
</span><span id=__span-6-83><a id=__codelineno-6-83 name=__codelineno-6-83 href=#__codelineno-6-83></a>                          <span class=err>│</span>  <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mi>0</span>
</span><span id=__span-6-84><a id=__codelineno-6-84 name=__codelineno-6-84 href=#__codelineno-6-84></a>                          <span class=err>└─</span> <span class=n>duration</span>
</span><span id=__span-6-85><a id=__codelineno-6-85 name=__codelineno-6-85 href=#__codelineno-6-85></a>                             <span class=err>⇒</span> <span class=n>Literal</span><span class=p>:</span> <span class=mf>0.1</span>
</span></code></pre></div> <h3 id=bloqade-emulator>Bloqade Emulator<a class=headerlink href=#bloqade-emulator title="Permanent link">&para;</a></h3> <p>Anyone familiar with QuEra’s Julia SDK <a href=https://github.com/QuEraComputing/Bloqade.jl><strong>Bloqade.jl</strong></a> knows that we’re pretty obsessed with performance. We would also be remiss to advertise Bloqade’s pure python emulator. While not as fast as <strong>Bloqade.jl</strong>, we have have worked to optimize our the state-vector simulator to get the most out of python as possible. The emulator supports both two and three level atom configurations, along with global and local driving and support for the blockade subspace (for those who are more familiar with Rydberg atoms). The blockade subspace and matrix calculations are nearly optimal for both memory and time and are written in pure NumPy and SciPy. We also have basic Numba JIT compiled sparse operations that further optimize the memory when solving the time-dependent Schrödinger equation. We hope our python emulator will allow you to explore a wide variety of applications for neutral atoms and prototype some neat new algorithms with AHS.</p> <blockquote> <p>Capitalize Bloqade across the entire article [name=jzlong]</p> </blockquote> <h3 id=target-multiple-backends>Target Multiple Backends<a class=headerlink href=#target-multiple-backends title="Permanent link">&para;</a></h3> <p>All Bloqade programs can be targeted to multiple emulation and hardware backends very easily, again using the chaining of <code>.</code>’s. Also note that the chaining syntax allows Bloqade to let you know exactly when a program should be able to be run. To select <code>braket</code> as your service simply select the <code>braket</code> attribute of your program. At this stage there will be two methods availible for you, <code>aquila</code> and <code>local_emulator</code>.</p> <blockquote> <p>I personally prefer to distinguish between methods and attributes by putting the <code>()</code> after a method name and omitting them for attributes [name=jzlong]</p> </blockquote> <p>Each backend has different restrictions in terms of the types of AHS programs that can be run. During the alpha phase of Bloqade we will continue to improve the error messages that are given when targeting specific backends making it easy for you to diagnose any issues with your program execution.</p> <p>Depending on the backend there are two or three methods for executing your program. For Cloud devices Bloqade has an API for both asynchronous (<code>run_async</code>) and synchronous (<code>run</code>) method for executing the job. Local emulator backends only support the <code>run</code> API.</p> <p>Now let us revisit the meaning of <code>args</code> assignment. Every execution method has a <code>args</code> argument, this is where you can specify the values of the parameters defined in <code>args</code> when defining your program. The order of the arguments in the <code>args</code> tuple is the order of the variables specified in the <code>args</code> method.</p> <blockquote> <p>a vs an? [name=jzlong]</p> </blockquote> <p>Finally the backend object that gets created is also callable where the such that <code>object(*args, shots=shots,...)</code> is equivalent to <code>object.run(shots, args=args, ...)</code>. While this is primarily a stylistic choice but this is an available interface for you if need be.</p> <blockquote> <p>"where the such that" -&gt; "such that" "While this is primarily a stylistic choice but this is an available" -&gt; "While this is primarily a stylicstic choice, this is also an available interface for you if need be" [name=jzlong]</p> </blockquote> <h3 id=job-management-features>Job management Features<a class=headerlink href=#job-management-features title="Permanent link">&para;</a></h3> <p>If you use the <code>batch_assign</code> API combined with your parameterized program it is possible to submit entire batches of AWS tasks. It's not enough to make programming AHS easy though; you also need to manage all the data that gets generated. Fear not, we have you covered. We know it can be quite cumbersome to have to manage hundreds or thousands of tasks so we have provided some useful functionality inside Bloqade to make your life easier as well as making experiments more reproducible.</p> <blockquote> <p>Fear not, we have you covered! (worth adding an exclamation mark just to go the full nine yards with the chippy/enthusiastic tone). [name=jzlong]</p> </blockquote> <p>One of the most common issues when running AHS (or just QC in general) is saving experimental results. When using a cloud device one also has the added difficultly of associating a task id with the parameter in the parameter scan as well as checking and fetching the task results as the tasks are completed. Bloqade provides a uniform format of saving this data which is useful for users to do sharable and reproducable work. To save your results simply invoke the <code>save</code> and <code>load</code> functions. We also provide <code>dumps</code> and <code>loads</code> if you want to work directly with strings instead of JSON files! It's as simple as:</p> <blockquote> <p>capitalize ID [name=jzlong]</p> </blockquote> <div class="language-python highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=kn>from</span> <span class=nn>bloqade</span> <span class=kn>import</span> <span class=n>save</span><span class=p>,</span> <span class=n>load</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=c1># define program</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=o>...</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=n>batch_task</span> <span class=o>=</span> <span class=n>my_program</span><span class=o>.</span><span class=n>braket</span><span class=o>.</span><span class=n>aquila</span><span class=p>()</span><span class=o>.</span><span class=n>run_async</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=n>save</span><span class=p>(</span><span class=n>batch_task</span><span class=p>,</span> <span class=err>“</span><span class=n>my_aquila_results</span><span class=o>.</span><span class=n>json</span><span class=err>”</span><span class=p>)</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=c1># in some other file:</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=n>loaded_batch_task</span> <span class=o>=</span> <span class=n>load</span><span class=p>(</span><span class=err>“</span><span class=n>my_aquila_results</span><span class=o>.</span><span class=n>json</span><span class=err>”</span><span class=p>)</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=c1># continue with analysis</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=o>...</span>
</span></code></pre></div> <p>These objects will contain all the necessary information to fetch results and obtain the values of parameters used in your program.</p> <p>Saving files isn’t all that Bloqade offers. When dealing with a Cloud device like Aquila it is important to be able to manage those asynchronous tasks. Bloqade offers different ways to do this:</p> <blockquote> <p>"...isn't all that Bloqade offers." -&gt; "..isn't all that Bloqade offers to make your life easier."</p> </blockquote> <ul> <li> <p><code>batch_task.fetch()</code> queries the current task statuses and fetches the results of completed tasks without blocking the python interpreter. The results are stored inside the current object.</p> </li> <li> <p><code>batch_task.pull()</code> Like fetch but waits until all tasks have been completed before unblocking the interpreter. The tasks the results are stored inside the current object.</p> </li> <li> <p><code>batch_task.get_tasks(*status_codes)</code> returns a new Batch object that contains the tasks with the status given by the inputs to the function</p> </li> <li> <p><code>batch_task.remove_tasks(*status_codes)</code> return a new Batch object that contains tasks that did not match the status code that have been given.</p> </li> </ul> <p>See the <a href=https://bloqade.quera.com/latest/reference/bloqade/task/batch/#bloqade.task.batch.RemoteBatch>documentation</a> for more details on what the various status codes are and what they mean.</p> <h2 id=adaptive-workloads>Adaptive workloads<a class=headerlink href=#adaptive-workloads title="Permanent link">&para;</a></h2> <p>As mentioned above, the ability to parameterize and assign values to your analog program means that there is a lot one can do in terms of running various kinds of experiments. Here we will discuss how to combine the parameterized pulses with braket’s hybrid jobs!</p> <p>In this case we can pass our parameterized pulse program into classical optimizer in order to provide classical feedback for the next quantum program to run. The use case we will cover here is a pretty standard problem that maps very neatly onto the AHS architecture implemented with Neutral atoms. Because of the Rydberg blockade effect the ground state of a collection of atoms maps exactly to what is called the Maximum Independent Set (MIS) problem on geometric graphs. The MIS problem is a graph coloring problem where the goal is to find the largest set of nodes in a graph such that no two nodes are connected by an edge. This problem is NP-hard and has many applications in scheduling, resource allocation, and even quantum error correction.</p> <blockquote> <p>I also think it better to use the term "Combinatorial Optimization" over "Graph Coloring" considering CO might open a broader window in people's minds for what the machine is capable of than just "Graph Coloring". It would also be nice to have links to examples for each application (MIS for scheduling, resource allocation, QEC.)</p> </blockquote> <p>We refer the reader to <a href=https://github.com/QuEraComputing/QuEra-braket-examples/blob/main/OptimizationTutorial/AWS_optimization_demo.ipynb>this</a> Notebook example for a more detailed explanation of the problem and how it maps onto AHS. For this blog post we will focus on the implementation of the hybrid algorithm using Bloqade and Braket Hybrid Jobs.</p> <p>Like most of the Bloqade programs we begin by importing the necessary components to build the program:</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>from</span> <span class=nn>bloqade</span> <span class=kn>import</span> <span class=n>RB_C6</span><span class=p>,</span> <span class=n>save</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>var</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=kn>from</span> <span class=nn>bloqade.atom_arrangement</span> <span class=kn>import</span> <span class=n>Square</span>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>from</span> <span class=nn>braket.devices</span> <span class=kn>import</span> <span class=n>Devices</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kn>from</span> <span class=nn>braket.aws</span> <span class=kn>import</span> <span class=n>AwsDevice</span>
</span></code></pre></div> <p>using the <code>AwsDevice</code> we can get some information about the capabilities of the device. Note that Bloqade uses <code>rad/us</code> and <code>us</code> for energy and time units respectively while braket uses SI unites, e.g. <code>rad/s</code> and <code>s</code>, hence the conversion of units below.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># define the parameters of the experiment</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=n>device</span> <span class=o>=</span> <span class=n>AwsDevice</span><span class=p>(</span><span class=n>Devices</span><span class=o>.</span><span class=n>QuEra</span><span class=o>.</span><span class=n>Aquila</span><span class=p>)</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=n>rydberg_properties</span> <span class=o>=</span> <span class=n>device</span><span class=o>.</span><span class=n>properties</span><span class=o>.</span><span class=n>paradigm</span><span class=o>.</span><span class=n>rydberg</span><span class=o>.</span><span class=n>rydbergGlobal</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=c1># Convert energy units to rad/us and time to us</span>
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=n>detuning_max</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>rydberg_properties</span><span class=o>.</span><span class=n>detuningRange</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=mf>1e6</span>
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=n>rabi_max</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>rydberg_properties</span><span class=o>.</span><span class=n>rabiFrequencyRange</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>/</span> <span class=mf>1e6</span>
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=n>total_time</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>rydberg_properties</span><span class=o>.</span><span class=n>timeMax</span><span class=p>)</span> <span class=o>*</span> <span class=mf>1e6</span>
</span></code></pre></div> <p>For the particular problem we are studying we need to map the problem graph onto the atom arrangement. For more information we refer the reader to the notebook <a href=https://github.com/QuEraComputing/QuEra-braket-examples/blob/main/OptimizationTutorial/AWS_optimization_demo.ipynb>example</a>.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># make sure next nearest neighbors are blockaded</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>Rmin</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span> <span class=c1># minimum unit disk radius</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=n>Rmax</span> <span class=o>=</span> <span class=mi>2</span>  <span class=c1># maximum unit disk radius</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=n>Rudg</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>Rmin</span> <span class=o>*</span> <span class=n>Rmax</span><span class=p>)</span> <span class=c1># geometric mean of Rmin and Rmax</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=n>detuning_end</span> <span class=o>=</span> <span class=n>detuning_max</span> <span class=o>/</span> <span class=mi>4</span> <span class=c1># detuning at the end of the pulse</span>
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=n>blockade_radius</span> <span class=o>=</span> <span class=p>(</span><span class=n>RB_C6</span> <span class=o>/</span> <span class=n>detuning_end</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=mi>1</span> <span class=o>/</span> <span class=mi>6</span><span class=p>)</span>
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=n>lattice_spacing</span> <span class=o>=</span> <span class=n>blockade_radius</span> <span class=o>/</span> <span class=n>Rudg</span>
</span></code></pre></div> <p>Now we can define the program. We will use the <code>var</code> function to define the parameters for the program. Also the cost function will involve calculating the final energy of tha atoms which can be obtained from the geometry of the program via the <code>rydberg_interaction</code> method.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># define the time step for the detuning waveform</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=n>dt</span> <span class=o>=</span> <span class=mf>0.4</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=n>n_steps</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>total_time</span> <span class=o>/</span> <span class=n>dt</span><span class=p>)</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># create variables for the detuning time steps</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=n>detuning_vars</span> <span class=o>=</span> <span class=p>[</span><span class=n>var</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;d</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n_steps</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=c1># define the lattice size before defect insertion</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=n>L</span> <span class=o>=</span> <span class=mi>4</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=c1># set seed for defect generation</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=n>rng</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>default_rng</span><span class=p>(</span><span class=mi>1337</span><span class=p>)</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=c1># define the geometry of the program</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=n>geometry</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>    <span class=n>Square</span><span class=p>(</span><span class=n>L</span><span class=p>,</span> <span class=n>lattice_spacing</span><span class=p>)</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>    <span class=o>.</span><span class=n>apply_defect_count</span><span class=p>(</span><span class=n>L</span><span class=o>**</span><span class=mi>2</span> <span class=o>//</span> <span class=mi>2</span><span class=p>,</span> <span class=n>rng</span><span class=o>=</span><span class=n>rng</span><span class=p>)</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>    <span class=o>.</span><span class=n>remove_vacant_sites</span><span class=p>()</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=p>)</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=c1># define the program</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=n>program</span> <span class=o>=</span> <span class=p>(</span>
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a>    <span class=n>geometry</span><span class=o>.</span><span class=n>rydberg</span><span class=o>.</span><span class=n>detuning</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>piecewise_linear</span><span class=p>(</span>
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>        <span class=n>n_steps</span> <span class=o>*</span> <span class=p>[</span><span class=n>dt</span><span class=p>],</span> <span class=p>[</span><span class=o>-</span><span class=n>detuning_end</span><span class=p>]</span> <span class=o>+</span> <span class=n>detuning_vars</span> <span class=o>+</span> <span class=p>[</span><span class=n>detuning_end</span><span class=p>]</span>
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a>    <span class=p>)</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a>    <span class=o>.</span><span class=n>amplitude</span><span class=o>.</span><span class=n>uniform</span><span class=o>.</span><span class=n>piecewise_linear</span><span class=p>(</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>        <span class=p>[</span><span class=mf>0.1</span><span class=p>,</span> <span class=n>total_time</span> <span class=o>-</span> <span class=mf>0.2</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>],</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=n>rabi_max</span><span class=p>,</span> <span class=n>rabi_max</span><span class=p>,</span> <span class=mi>0</span><span class=p>]</span>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a>    <span class=p>)</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=p>)</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=c1># get the interaction matrix</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=n>V_ij</span> <span class=o>=</span> <span class=n>geometry</span><span class=o>.</span><span class=n>interaction_matrix</span><span class=p>()</span>
</span></code></pre></div> <p>We need to build the infrastructure to do the hybrid job. There are many different tools availible in <code>braket.jobs</code> that allow you to log the progress of your hybrid algorithm. Here we set up a simple class that wraps the cost function and log the progress of the algorithm.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=kn>from</span> <span class=nn>braket.jobs</span> <span class=kn>import</span> <span class=p>(</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>    <span class=n>InstanceConfig</span><span class=p>,</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>    <span class=n>hybrid_job</span><span class=p>,</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>    <span class=n>save_job_checkpoint</span><span class=p>,</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=p>)</span>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=kn>from</span> <span class=nn>braket.jobs.metrics</span> <span class=kn>import</span> <span class=n>log_metric</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=kn>from</span> <span class=nn>braket.jobs_data</span> <span class=kn>import</span> <span class=n>PersistedJobDataFormat</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=kn>from</span> <span class=nn>braket.tracking</span> <span class=kn>import</span> <span class=n>Tracker</span>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=c1># define a wrapper for the cost function for reporting</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=k>class</span> <span class=nc>CostFuncWrapper</span><span class=p>:</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>backend</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>):</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a>        <span class=bp>self</span><span class=o>.</span><span class=n>backend</span> <span class=o>=</span> <span class=n>backend</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>        <span class=bp>self</span><span class=o>.</span><span class=n>options</span> <span class=o>=</span> <span class=n>options</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>        <span class=bp>self</span><span class=o>.</span><span class=n>iterations</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a>        <span class=bp>self</span><span class=o>.</span><span class=n>shots</span> <span class=o>=</span> <span class=n>shots</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_calls</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a>        <span class=bp>self</span><span class=o>.</span><span class=n>task_tracker</span> <span class=o>=</span> <span class=n>Tracker</span><span class=p>()</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>
</span><span id=__span-12-20><a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a>    <span class=nd>@staticmethod</span>
</span><span id=__span-12-21><a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a>    <span class=k>def</span> <span class=nf>cost_func</span><span class=p>(</span><span class=n>report</span><span class=p>):</span>
</span><span id=__span-12-22><a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a>        <span class=n>bitstrings</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=n>report</span><span class=o>.</span><span class=n>bitstrings</span><span class=p>(</span><span class=kc>False</span><span class=p>))</span>
</span><span id=__span-12-23><a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a>        <span class=n>detuning_energies</span> <span class=o>=</span> <span class=o>-</span><span class=n>detuning_end</span> <span class=o>*</span> <span class=n>bitstrings</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-12-24><a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a>        <span class=n>interaction_energies</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>einsum</span><span class=p>(</span>
</span><span id=__span-12-25><a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a>            <span class=s2>&quot;ij, ...i, ...j-&gt; ...&quot;</span><span class=p>,</span> <span class=n>V_ij</span><span class=p>,</span> <span class=n>bitstrings</span><span class=p>,</span> <span class=n>bitstrings</span>
</span><span id=__span-12-26><a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a>        <span class=p>)</span>
</span><span id=__span-12-27><a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a>
</span><span id=__span-12-28><a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a>        <span class=n>total_energy</span> <span class=o>=</span> <span class=n>detuning_energies</span> <span class=o>+</span> <span class=n>interaction_energies</span>
</span><span id=__span-12-29><a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a>        <span class=c1># minimize the energy mean and standard deviation</span>
</span><span id=__span-12-30><a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a>        <span class=k>return</span> <span class=n>total_energy</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span> <span class=o>+</span> <span class=n>total_energy</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
</span><span id=__span-12-31><a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a>
</span><span id=__span-12-32><a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span><span id=__span-12-33><a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a>        <span class=n>args</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-12-34><a id=__codelineno-12-34 name=__codelineno-12-34 href=#__codelineno-12-34></a>
</span><span id=__span-12-35><a id=__codelineno-12-35 name=__codelineno-12-35 href=#__codelineno-12-35></a>        <span class=n>batch_task</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>backend</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>shots</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=bp>self</span><span class=o>.</span><span class=n>options</span><span class=p>)</span>
</span><span id=__span-12-36><a id=__codelineno-12-36 name=__codelineno-12-36 href=#__codelineno-12-36></a>        <span class=n>report</span> <span class=o>=</span> <span class=n>batch_task</span><span class=o>.</span><span class=n>report</span><span class=p>()</span>
</span><span id=__span-12-37><a id=__codelineno-12-37 name=__codelineno-12-37 href=#__codelineno-12-37></a>
</span><span id=__span-12-38><a id=__codelineno-12-38 name=__codelineno-12-38 href=#__codelineno-12-38></a>        <span class=n>save</span><span class=p>(</span><span class=n>batch_task</span><span class=p>,</span> <span class=sa>f</span><span class=s2>&quot;my-aquila_results-</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=si>}</span><span class=s2>.json&quot;</span><span class=p>)</span>
</span><span id=__span-12-39><a id=__codelineno-12-39 name=__codelineno-12-39 href=#__codelineno-12-39></a>
</span><span id=__span-12-40><a id=__codelineno-12-40 name=__codelineno-12-40 href=#__codelineno-12-40></a>        <span class=bp>self</span><span class=o>.</span><span class=n>prev_calls</span><span class=p>[</span><span class=n>args</span><span class=p>]</span> <span class=o>=</span> <span class=n>report</span>
</span><span id=__span-12-41><a id=__codelineno-12-41 name=__codelineno-12-41 href=#__codelineno-12-41></a>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>cost_func</span><span class=p>(</span><span class=n>report</span><span class=p>)</span>
</span><span id=__span-12-42><a id=__codelineno-12-42 name=__codelineno-12-42 href=#__codelineno-12-42></a>
</span><span id=__span-12-43><a id=__codelineno-12-43 name=__codelineno-12-43 href=#__codelineno-12-43></a>    <span class=k>def</span> <span class=nf>callback</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>state</span><span class=p>):</span>
</span><span id=__span-12-44><a id=__codelineno-12-44 name=__codelineno-12-44 href=#__codelineno-12-44></a>        <span class=n>args</span> <span class=o>=</span> <span class=nb>tuple</span><span class=p>(</span><span class=n>state</span><span class=o>.</span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-12-45><a id=__codelineno-12-45 name=__codelineno-12-45 href=#__codelineno-12-45></a>        <span class=bp>self</span><span class=o>.</span><span class=n>iterations</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-12-46><a id=__codelineno-12-46 name=__codelineno-12-46 href=#__codelineno-12-46></a>        <span class=n>bitstrings</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>np</span><span class=o>.</span><span class=n>asarray</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>prev_calls</span><span class=p>[</span><span class=n>args</span><span class=p>]</span><span class=o>.</span><span class=n>bitstrings</span><span class=p>(</span><span class=kc>False</span><span class=p>))</span>
</span><span id=__span-12-47><a id=__codelineno-12-47 name=__codelineno-12-47 href=#__codelineno-12-47></a>        <span class=n>detuning_energies</span> <span class=o>=</span> <span class=o>-</span><span class=n>detuning_end</span> <span class=o>*</span> <span class=n>bitstrings</span><span class=o>.</span><span class=n>sum</span><span class=p>(</span><span class=n>axis</span><span class=o>=-</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-12-48><a id=__codelineno-12-48 name=__codelineno-12-48 href=#__codelineno-12-48></a>
</span><span id=__span-12-49><a id=__codelineno-12-49 name=__codelineno-12-49 href=#__codelineno-12-49></a>        <span class=n>interaction_energies</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>einsum</span><span class=p>(</span>
</span><span id=__span-12-50><a id=__codelineno-12-50 name=__codelineno-12-50 href=#__codelineno-12-50></a>            <span class=s2>&quot;ij, ...i, ...j-&gt; ...&quot;</span><span class=p>,</span> <span class=n>V_ij</span><span class=p>,</span> <span class=n>bitstrings</span><span class=p>,</span> <span class=n>bitstrings</span>
</span><span id=__span-12-51><a id=__codelineno-12-51 name=__codelineno-12-51 href=#__codelineno-12-51></a>        <span class=p>)</span>
</span><span id=__span-12-52><a id=__codelineno-12-52 name=__codelineno-12-52 href=#__codelineno-12-52></a>
</span><span id=__span-12-53><a id=__codelineno-12-53 name=__codelineno-12-53 href=#__codelineno-12-53></a>        <span class=n>total_energy</span> <span class=o>=</span> <span class=n>detuning_energies</span> <span class=o>+</span> <span class=n>interaction_energies</span>
</span><span id=__span-12-54><a id=__codelineno-12-54 name=__codelineno-12-54 href=#__codelineno-12-54></a>        <span class=n>mean_energy</span> <span class=o>=</span> <span class=n>total_energy</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span><span id=__span-12-55><a id=__codelineno-12-55 name=__codelineno-12-55 href=#__codelineno-12-55></a>        <span class=n>std_energy</span> <span class=o>=</span> <span class=n>total_energy</span><span class=o>.</span><span class=n>std</span><span class=p>()</span>
</span><span id=__span-12-56><a id=__codelineno-12-56 name=__codelineno-12-56 href=#__codelineno-12-56></a>
</span><span id=__span-12-57><a id=__codelineno-12-57 name=__codelineno-12-57 href=#__codelineno-12-57></a>        <span class=c1># Log metrics to display in Braket Console</span>
</span><span id=__span-12-58><a id=__codelineno-12-58 name=__codelineno-12-58 href=#__codelineno-12-58></a>        <span class=n>log_metric</span><span class=p>(</span>
</span><span id=__span-12-59><a id=__codelineno-12-59 name=__codelineno-12-59 href=#__codelineno-12-59></a>            <span class=n>iteration_number</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=p>,</span> <span class=n>value</span><span class=o>=</span><span class=n>state</span><span class=o>.</span><span class=n>fun</span><span class=p>,</span> <span class=n>metric_name</span><span class=o>=</span><span class=s2>&quot;loss&quot;</span>
</span><span id=__span-12-60><a id=__codelineno-12-60 name=__codelineno-12-60 href=#__codelineno-12-60></a>        <span class=p>)</span>
</span><span id=__span-12-61><a id=__codelineno-12-61 name=__codelineno-12-61 href=#__codelineno-12-61></a>        <span class=n>log_metric</span><span class=p>(</span>
</span><span id=__span-12-62><a id=__codelineno-12-62 name=__codelineno-12-62 href=#__codelineno-12-62></a>            <span class=n>iteration_number</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=p>,</span>
</span><span id=__span-12-63><a id=__codelineno-12-63 name=__codelineno-12-63 href=#__codelineno-12-63></a>            <span class=n>value</span><span class=o>=</span><span class=n>mean_energy</span><span class=p>,</span>
</span><span id=__span-12-64><a id=__codelineno-12-64 name=__codelineno-12-64 href=#__codelineno-12-64></a>            <span class=n>metric_name</span><span class=o>=</span><span class=s2>&quot;mean energy&quot;</span><span class=p>,</span>
</span><span id=__span-12-65><a id=__codelineno-12-65 name=__codelineno-12-65 href=#__codelineno-12-65></a>        <span class=p>)</span>
</span><span id=__span-12-66><a id=__codelineno-12-66 name=__codelineno-12-66 href=#__codelineno-12-66></a>        <span class=n>log_metric</span><span class=p>(</span>
</span><span id=__span-12-67><a id=__codelineno-12-67 name=__codelineno-12-67 href=#__codelineno-12-67></a>            <span class=n>iteration_number</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=p>,</span>
</span><span id=__span-12-68><a id=__codelineno-12-68 name=__codelineno-12-68 href=#__codelineno-12-68></a>            <span class=n>value</span><span class=o>=</span><span class=n>std_energy</span><span class=p>,</span>
</span><span id=__span-12-69><a id=__codelineno-12-69 name=__codelineno-12-69 href=#__codelineno-12-69></a>            <span class=n>metric_name</span><span class=o>=</span><span class=s2>&quot;std energy&quot;</span><span class=p>,</span>
</span><span id=__span-12-70><a id=__codelineno-12-70 name=__codelineno-12-70 href=#__codelineno-12-70></a>        <span class=p>)</span>
</span><span id=__span-12-71><a id=__codelineno-12-71 name=__codelineno-12-71 href=#__codelineno-12-71></a>
</span><span id=__span-12-72><a id=__codelineno-12-72 name=__codelineno-12-72 href=#__codelineno-12-72></a>        <span class=c1># Also track the quantum task cost for Braket devices</span>
</span><span id=__span-12-73><a id=__codelineno-12-73 name=__codelineno-12-73 href=#__codelineno-12-73></a>        <span class=n>braket_task_cost</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span>
</span><span id=__span-12-74><a id=__codelineno-12-74 name=__codelineno-12-74 href=#__codelineno-12-74></a>            <span class=bp>self</span><span class=o>.</span><span class=n>task_tracker</span><span class=o>.</span><span class=n>qpu_tasks_cost</span><span class=p>()</span>
</span><span id=__span-12-75><a id=__codelineno-12-75 name=__codelineno-12-75 href=#__codelineno-12-75></a>            <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>task_tracker</span><span class=o>.</span><span class=n>simulator_tasks_cost</span><span class=p>()</span>
</span><span id=__span-12-76><a id=__codelineno-12-76 name=__codelineno-12-76 href=#__codelineno-12-76></a>        <span class=p>)</span>
</span><span id=__span-12-77><a id=__codelineno-12-77 name=__codelineno-12-77 href=#__codelineno-12-77></a>        <span class=n>log_metric</span><span class=p>(</span>
</span><span id=__span-12-78><a id=__codelineno-12-78 name=__codelineno-12-78 href=#__codelineno-12-78></a>            <span class=n>metric_name</span><span class=o>=</span><span class=s2>&quot;braket_cost&quot;</span><span class=p>,</span>
</span><span id=__span-12-79><a id=__codelineno-12-79 name=__codelineno-12-79 href=#__codelineno-12-79></a>            <span class=n>value</span><span class=o>=</span><span class=n>braket_task_cost</span><span class=p>,</span>
</span><span id=__span-12-80><a id=__codelineno-12-80 name=__codelineno-12-80 href=#__codelineno-12-80></a>            <span class=n>iteration_number</span><span class=o>=</span><span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=p>,</span>
</span><span id=__span-12-81><a id=__codelineno-12-81 name=__codelineno-12-81 href=#__codelineno-12-81></a>        <span class=p>)</span>
</span><span id=__span-12-82><a id=__codelineno-12-82 name=__codelineno-12-82 href=#__codelineno-12-82></a>
</span><span id=__span-12-83><a id=__codelineno-12-83 name=__codelineno-12-83 href=#__codelineno-12-83></a>        <span class=c1># Save a checkpoint to resume the hybrid job from where you left off</span>
</span><span id=__span-12-84><a id=__codelineno-12-84 name=__codelineno-12-84 href=#__codelineno-12-84></a>        <span class=n>checkpoint_data</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&quot;i&quot;</span><span class=p>:</span> <span class=bp>self</span><span class=o>.</span><span class=n>iterations</span><span class=p>,</span> <span class=s2>&quot;args&quot;</span><span class=p>:</span> <span class=n>args</span><span class=p>}</span>
</span><span id=__span-12-85><a id=__codelineno-12-85 name=__codelineno-12-85 href=#__codelineno-12-85></a>        <span class=n>save_job_checkpoint</span><span class=p>(</span>
</span><span id=__span-12-86><a id=__codelineno-12-86 name=__codelineno-12-86 href=#__codelineno-12-86></a>            <span class=n>checkpoint_data</span><span class=p>,</span> <span class=n>data_format</span><span class=o>=</span><span class=n>PersistedJobDataFormat</span><span class=o>.</span><span class=n>PICKLED_V4</span>
</span><span id=__span-12-87><a id=__codelineno-12-87 name=__codelineno-12-87 href=#__codelineno-12-87></a>        <span class=p>)</span>
</span><span id=__span-12-88><a id=__codelineno-12-88 name=__codelineno-12-88 href=#__codelineno-12-88></a>        <span class=c1># end the job if the std energy is less than 5% of the mean energy</span>
</span><span id=__span-12-89><a id=__codelineno-12-89 name=__codelineno-12-89 href=#__codelineno-12-89></a>        <span class=c1># this indicates that the system is close to the ground state</span>
</span><span id=__span-12-90><a id=__codelineno-12-90 name=__codelineno-12-90 href=#__codelineno-12-90></a>        <span class=k>return</span> <span class=nb>abs</span><span class=p>(</span><span class=n>std_energy</span> <span class=o>/</span> <span class=n>mean_energy</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mf>0.05</span>
</span></code></pre></div> <p>While this is a lot to take in let us go through some important things. Firstly, you can generate a <code>Report</code> object from a Bloqade batch of tasks. This object provides some basic analysis methods common to Neutral atom AHS computing. The one we make the most use of here is the <code>bitstrings</code> method which return a list of arrays that contains the shot results after executing the program. It takes a boolean argument that specifies whether or not to return the bitstrings of shots where there were atoms that did not get put into a trap before the computation was executed. By default this filter is applied, but for this problem we want to include those shots in our analysis hence the <code>False</code> argument.</p> <blockquote> <p>No need to capitalize "Batch" unless you want to refer to the object type You can just say AHS, AHS Computing seems redundant Do we assume users know what a trap is? Might be worth having a sentence or two, just say something like "It takes a boolean argument that specifies whether or not to return the bitstrings of shots where there were atoms that did not successfully get put into position..."</p> </blockquote> <p>Another thing to note is that our cost function not only contains the <code>mean</code> energy but also the standard deviation. The reason for this is because we are targeting an eigenstate of the final Hamiltonian which has no energy variance. This is a good way to check if the system is in the ground state. We use the ratio of the standard deviation to the mean energy as a stopping condition for the algorithm.</p> <p>Finally, we have a callback function that is called after each iteration of the optimizer. This is where we can log the progress of the algorithm. We use the <code>Tracker</code> object to track the cost of the quantum tasks that are being executed. We also use the <code>log_metric</code> function to log the mean and standard deviation of the energy as well as the cost function of the quantum tasks.</p> <p>Now we can define the function that will run the hybrid job.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>def</span> <span class=nf>run_algo</span><span class=p>(</span><span class=n>assigned_program</span><span class=p>,</span> <span class=n>device_arn</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>n_calls</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=mi>10</span><span class=p>):</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=nd>@hybrid_job</span><span class=p>(</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>        <span class=n>device</span><span class=o>=</span><span class=n>device_arn</span><span class=p>,</span>  <span class=c1># Which device to get priority access to</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>        <span class=n>dependencies</span><span class=o>=</span><span class=s2>&quot;requirements.txt&quot;</span><span class=p>,</span>  <span class=c1># install bloqade</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>        <span class=n>instance_config</span><span class=o>=</span><span class=n>InstanceConfig</span><span class=p>(</span><span class=s2>&quot;ml.m5.large&quot;</span><span class=p>),</span>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>    <span class=p>)</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>    <span class=k>def</span> <span class=nf>_runner</span><span class=p>(</span><span class=n>backend</span><span class=p>,</span> <span class=n>shots</span><span class=p>,</span> <span class=n>n_calls</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>):</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>        <span class=kn>from</span> <span class=nn>skopt</span> <span class=kn>import</span> <span class=n>gp_minimize</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a>        <span class=c1># Braket task cost</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>        <span class=n>wrapped_cost_func</span> <span class=o>=</span> <span class=n>CostFuncWrapper</span><span class=p>(</span><span class=n>backend</span><span class=p>,</span> <span class=n>shots</span><span class=o>=</span><span class=n>shots</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>)</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>        <span class=n>n_params</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>backend</span><span class=o>.</span><span class=n>params</span><span class=o>.</span><span class=n>args_list</span><span class=p>)</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>        <span class=n>bounds</span> <span class=o>=</span> <span class=n>n_params</span> <span class=o>*</span> <span class=p>[(</span><span class=o>-</span><span class=n>detuning_max</span><span class=p>,</span> <span class=n>detuning_max</span><span class=p>)]</span>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>gp_minimize</span><span class=p>(</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>            <span class=n>wrapped_cost_func</span><span class=p>,</span>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a>            <span class=n>bounds</span><span class=p>,</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a>            <span class=n>callback</span><span class=o>=</span><span class=n>wrapped_cost_func</span><span class=o>.</span><span class=n>callback</span><span class=p>,</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a>            <span class=n>n_calls</span><span class=o>=</span><span class=n>n_calls</span><span class=p>,</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a>        <span class=p>)</span>
</span><span id=__span-13-22><a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a>
</span><span id=__span-13-23><a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a>        <span class=n>detuning_values</span> <span class=o>=</span> <span class=p>{</span><span class=n>var</span><span class=o>.</span><span class=n>name</span><span class=p>:</span> <span class=n>val</span> <span class=k>for</span> <span class=n>var</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>detuning_vars</span><span class=p>,</span> <span class=n>result</span><span class=o>.</span><span class=n>x</span><span class=p>)}</span>
</span><span id=__span-13-24><a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a>
</span><span id=__span-13-25><a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a>        <span class=k>return</span> <span class=n>detuning_values</span>
</span><span id=__span-13-26><a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a>
</span><span id=__span-13-27><a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a>    <span class=k>if</span> <span class=n>device_arn</span> <span class=o>==</span> <span class=n>Devices</span><span class=o>.</span><span class=n>QuEra</span><span class=o>.</span><span class=n>Aquila</span><span class=p>:</span>  <span class=c1># use Aquila</span>
</span><span id=__span-13-28><a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a>        <span class=n>backend</span> <span class=o>=</span> <span class=n>assigned_program</span><span class=o>.</span><span class=n>braket</span><span class=o>.</span><span class=n>aquila</span><span class=p>()</span>
</span><span id=__span-13-29><a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a>        <span class=n>options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>()</span>
</span><span id=__span-13-30><a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a>    <span class=k>else</span><span class=p>:</span>  <span class=c1># use  bloqade emulator</span>
</span><span id=__span-13-31><a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a>        <span class=n>backend</span> <span class=o>=</span> <span class=n>assigned_program</span><span class=o>.</span><span class=n>bloqade</span><span class=o>.</span><span class=n>python</span><span class=p>()</span>
</span><span id=__span-13-32><a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a>        <span class=n>options</span> <span class=o>=</span> <span class=nb>dict</span><span class=p>(</span><span class=n>atol</span><span class=o>=</span><span class=mf>1e-8</span><span class=p>,</span> <span class=n>rtol</span><span class=o>=</span><span class=mf>1e-4</span><span class=p>,</span> <span class=n>solver_name</span><span class=o>=</span><span class=s2>&quot;dopri5&quot;</span><span class=p>)</span>
</span><span id=__span-13-33><a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a>
</span><span id=__span-13-34><a id=__codelineno-13-34 name=__codelineno-13-34 href=#__codelineno-13-34></a>    <span class=c1># Run the hybrid job</span>
</span><span id=__span-13-35><a id=__codelineno-13-35 name=__codelineno-13-35 href=#__codelineno-13-35></a>    <span class=k>return</span> <span class=n>_runner</span><span class=p>(</span><span class=n>backend</span><span class=p>,</span> <span class=n>n_calls</span><span class=p>,</span> <span class=n>shots</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>)</span>
</span></code></pre></div> <p>We use the <code>hybrid_job</code> decorator to define the hybrid job. This decorator takes a <code>device_arn</code> argument which is the Amazon Resource Name (ARN) of the device you want to run the hybrid job on. There are some other options associated with the EC2 instance that is used to run the hybrid job. We will use the <code>InstanceConfig</code> object to specify the instance type and number of instances to use. <code>dependencies</code> points to a text file that contains the python dependencies needed to run this hybrid job. In this case we need <code>bloqade</code> and <code>scikit-optimize</code> in this text file.</p> <p>The function <code>_runner</code> that is being decorated must take the <code>backend</code> as the first argument. This object is generated by the Bloqade API and must match the device arn that is specified in the decorator. <code>n_calls</code> is the total number of iterations of the optimizer and <code>shots</code> is the number of shots to use for each iteration. <code>options</code> is a dictionary of options that are passed to the <code>run</code> method of the backend. The return value of the function is the final value of the parameters that were optimized. We wrap the <code>_runner</code> inside <code>run_algo</code> that takes the <code>program</code> and the <code>device_arn</code> as arguments to make sure that the device requested by <code>hybrid_jobs</code> matches the device called by <code>bloqade</code> as well as setting up specialized <code>options</code> for the different <code>bloqade</code> backends.</p> <p>To run the hybrid job we simply call the <code>run_algo</code> function with the assigned program and the device arn.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=n>optimal_parameters</span> <span class=o>=</span> <span class=n>run_algo</span><span class=p>(</span><span class=n>program</span><span class=o>.</span><span class=n>args</span><span class=p>(</span><span class=n>detuning_vars</span><span class=p>),</span> <span class=n>device_arn</span><span class=o>=</span><span class=n>Devices</span><span class=o>.</span><span class=n>QuEra</span><span class=o>.</span><span class=n>Aquila</span><span class=p>)</span>
</span></code></pre></div> <p>Finally we can plot the results of the hybrid job.</p> <div class="language-python highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>assigned_program</span> <span class=o>=</span> <span class=n>program</span><span class=o>.</span><span class=n>assign</span><span class=p>(</span><span class=o>**</span><span class=n>optimal_params</span><span class=p>)</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=n>assigned_program</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></code></pre></div> <p>To run the algorithm with Bloqade emulator we simply change the device arn to None.</p> <p>Full source code:</p> <p>```python= import numpy as np from bloqade import RB_C6, save, start, var from bloqade.atom_arrangement import Square from braket.devices import Devices from braket.aws import AwsDevice</p> <h1 id=define-the-parameters-of-the-experiment>define the parameters of the experiment<a class=headerlink href=#define-the-parameters-of-the-experiment title="Permanent link">&para;</a></h1> <p>device = AwsDevice(Devices.QuEra.Aquila) rydberg_properties = device.properties.paradigm.rydberg.rydbergGlobal</p> <h1 id=convert-energy-units-to-radus-and-time-to-us>Convert energy units to rad/us and time to us<a class=headerlink href=#convert-energy-units-to-radus-and-time-to-us title="Permanent link">&para;</a></h1> <p>detuning_max = float(rydberg_properties.detuningRange[1]) / 1e6 rabi_max = float(rydberg_properties.rabiFrequencyRange[1]) / 1e6 total_time = float(rydberg_properties.timeMax) * 1e6</p> <h1 id=make-sure-next-nearest-neighbors-are-blockaded>make sure next nearest neighbors are blockaded<a class=headerlink href=#make-sure-next-nearest-neighbors-are-blockaded title="Permanent link">&para;</a></h1> <h1 id=unit-disk-minimum-and-maximum-radii>unit disk minimum and maximum radii<a class=headerlink href=#unit-disk-minimum-and-maximum-radii title="Permanent link">&para;</a></h1> <p>Rmin = np.sqrt(2) # minimum unit disk radius Rmax = 2 # maximum unit disk radius</p> <h1 id=choose-geometric-mean-of-rmin-and-rmax>choose geometric mean of Rmin and Rmax<a class=headerlink href=#choose-geometric-mean-of-rmin-and-rmax title="Permanent link">&para;</a></h1> <p>Rudg = np.sqrt(Rmin * Rmax)</p> <p>detuning_end = detuning_max / 4 blockade_radius = (RB_C6 / detuning_end) ** (1 / 6) lattice_spacing = blockade_radius / Rudg</p> <h1 id=define-the-time-step-for-the-detuning-waveform>define the time step for the detuning waveform<a class=headerlink href=#define-the-time-step-for-the-detuning-waveform title="Permanent link">&para;</a></h1> <p>dt = 0.4 n_steps = int(total_time / dt)</p> <h1 id=create-variables-for-the-detuning-time-steps>create variables for the detuning time steps<a class=headerlink href=#create-variables-for-the-detuning-time-steps title="Permanent link">&para;</a></h1> <p>detuning_vars = [var(f"d{i}") for i in range(n_steps - 1)]</p> <h1 id=define-the-lattice-size-before-defect-insertion>define the lattice size before defect insertion<a class=headerlink href=#define-the-lattice-size-before-defect-insertion title="Permanent link">&para;</a></h1> <p>L = 4</p> <h1 id=set-seed-for-geometry-generation>set seed for geometry generation<a class=headerlink href=#set-seed-for-geometry-generation title="Permanent link">&para;</a></h1> <p>rng = np.random.default_rng(1337) program = ( Square(L, lattice_spacing) .apply_defect_count(L**2 // 2, rng=rng) .remove_vacant_sites() .rydberg.detuning.uniform.piecewise_linear( n_steps * [dt], [-detuning_end] + detuning_vars + [detuning_end] ) .amplitude.uniform.piecewise_linear( [0.1, total_time - 0.2, 0.1], [0, rabi_max, rabi_max, 0] ) )</p> <h1 id=get-atom-register-and-interaction-matrix>get atom register and interaction matrix<a class=headerlink href=#get-atom-register-and-interaction-matrix title="Permanent link">&para;</a></h1> <p>V_ij = program.parse_register().rydberg_interaction()</p> <p>from braket.jobs import ( InstanceConfig, hybrid_job, save_job_checkpoint, ) from braket.jobs.metrics import log_metric from braket.jobs_data import PersistedJobDataFormat from braket.tracking import Tracker</p> <h1 id=define-a-wrapper-for-the-cost-function-for-reporting>define a wrapper for the cost function for reporting<a class=headerlink href=#define-a-wrapper-for-the-cost-function-for-reporting title="Permanent link">&para;</a></h1> <p>class CostFuncWrapper: def <strong>init</strong>(self, cost_func, backend, shots=10, **options): self.backend = backend self.options = options self.iterations = 0 self.shots = shots self.prev_calls = {} self.task_tracker = Tracker().start()</p> <div class="language-text highlight"><pre><span></span><code>@staticmethod
def cost_func(report):
    bitstrings = 1 - np.asarray(report.bitstrings(False))
    detuning_energies = -detuning_end * bitstrings.sum(axis=-1)
    interaction_energies = np.einsum(
        &quot;ij, ...i, ...j-&gt; ...&quot;, V_ij, bitstrings, bitstrings
    )

    total_energy = detuning_energies + interaction_energies
    # minimize the energy mean and standard deviation
    return total_energy.mean() + total_energy.std()

def __call__(self, x):
    args = tuple(x)

    batch_task = self.backend.run(self.shots, args=args, **self.options)
    report = batch_task.report()

    save(batch_task, f&quot;my-aquila_results-{self.iterations}.json&quot;)

    self.prev_calls[args] = report
    return self.cost_func(report)

def callback(self, state):
    args = tuple(state.x)
    self.iterations += 1
    bitstrings = 1 - np.asarray(self.prev_calls[args].bitstrings(False))
    detuning_energies = -detuning_end * bitstrings.sum(axis=-1)

    interaction_energies = np.einsum(
        &quot;ij, ...i, ...j-&gt; ...&quot;, V_ij, bitstrings, bitstrings
    )

    total_energy = detuning_energies + interaction_energies
    mean_energy = total_energy.mean()
    std_energy = total_energy.std()

    # Log metrics to display in Braket Console
    log_metric(
        iteration_number=self.iterations, value=state.fun, metric_name=&quot;loss&quot;
    )
    log_metric(
        iteration_number=self.iterations,
        value=mean_energy,
        metric_name=&quot;mean energy&quot;,
    )
    log_metric(
        iteration_number=self.iterations,
        value=std_energy,
        metric_name=&quot;std energy&quot;,
    )

    # Also track the quantum task cost for Braket devices
    braket_task_cost = float(
        self.task_tracker.qpu_tasks_cost()
        + self.task_tracker.simulator_tasks_cost()
    )
    log_metric(
        metric_name=&quot;braket_cost&quot;,
        value=braket_task_cost,
        iteration_number=self.iterations,
    )

    # Save a checkpoint to resume the hybrid job from where you left off
    checkpoint_data = {&quot;i&quot;: self.iterations, &quot;args&quot;: args}
    save_job_checkpoint(
        checkpoint_data, data_format=PersistedJobDataFormat.PICKLED_V4
    )
    # end the job if the std energy is less than 5% of the mean energy
    # this indicates that the system is close to the ground state
    return abs(std_energy / mean_energy) &lt; 0.05
</code></pre></div> <p>def run_algo(assigned_program, device_arn=None, n_calls=10, shots=10): <a class="magiclink magiclink-github magiclink-mention" href=https://github.com/hybrid_job title="GitHub User: hybrid_job">@hybrid_job</a>( device=device_arn, # Which device to get priority access to dependencies="requirements.txt", # install bloqade instance_config=InstanceConfig("ml.m5.large"), ) def _runner(backend, shots, n_calls, **options): from skopt import gp_minimize</p> <div class="language-text highlight"><pre><span></span><code>    # Braket task cost
    wrapped_cost_func = CostFuncWrapper(backend, shots=shots, **options)

    n_params = len(backend.params.args_list)
    bounds = n_params * [(-detuning_max, detuning_max)]

    result = gp_minimize(
        wrapped_cost_func,
        bounds,
        callback=wrapped_cost_func.callback,
        n_calls=n_calls,
    )

    detuning_values = {var.name: val for var, val in zip(detuning_vars, result.x)}

    return detuning_values

if device_arn == Devices.QuEra.Aquila:  # use Aquila
    backend = assigned_program.braket.aquila()
    options = dict()
else:  # use  bloqade emulator
    backend = assigned_program.bloqade.python()
    options = dict(atol=1e-8, rtol=1e-4, solver_name=&quot;dopri5&quot;)

# Run the hybrid job
return _runner(backend, n_calls, shots, **options)
</code></pre></div> <h1 id=optimal_params-run_algoprogramargsdetuning_vars-devicesqueraaquila>optimal_params = run_algo(program.args(detuning_vars), Devices.QuEra.Aquila)<a class=headerlink href=#optimal_params-run_algoprogramargsdetuning_vars-devicesqueraaquila title="Permanent link">&para;</a></h1> <p>optimal_params = run_algo(program.args(detuning_vars), None, n_calls=10, shots=10)</p> <p>assigned_program = program.assign(**optimal_params) assigned_program.show()</p> <p>```</p> </article> </div> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 - QuEra Computing Inc. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/QuEraComputing/bloqade-python target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://pypi.org/project/bloqade/ target=_blank rel=noopener title=pypi.org class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> </a> <a href=https://twitter.com/QueraComputing target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.cd18aaf1.min.js></script> </body> </html>